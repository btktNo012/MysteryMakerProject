# SCREEN SPEC（画面仕様）雛形

本書は本プロジェクトの各画面（GamePhase）に関する仕様を整理・共有するための雛形です。以下のテンプレートに沿って、画面ごとの目的、主要UI、表示/操作制御、イベント、検証観点などを記述してください。

---

## 0. ドキュメント概要
- 目的: 各画面の要件・振る舞い・依存関係を明確化し、実装/テスト/保守を容易にする
- 想定読者: 開発者、テスター、ドキュメント作成者
- スコープ: クライアント画面（フロントエンド）中心。必要に応じてサーバイベントも触れる
- 前提: 役割（参加者/観戦者/ルームマスター）・GamePhaseの概念・シナリオデータ構造を理解していること

## 1. 共通テンプレート（画面ごとに複製して使用）
- 画面名/Phase:
- 目的/概要:
- 入口/遷移条件:
- 出口/次遷移（ボタン、イベント）:
- 主要UIコンポーネント（ファイル/識別子）:
- ステート/依存データ: `scenario`, `players`, `myPlayer`, `characterSelections`, `infoCards` 等
- 表示/操作制御:
  - 参加者:
  - 観戦者:
  - ルームマスター（兼参加者）の特権:
- フッター/ヘッダー仕様:
- ソケットイベント（受信/送信）:
- エラー/例外シナリオ:
- アクセシビリティ/操作性:
- ログ/テレメトリ（ゲームログ含む）:
- テスト観点/受け入れ条件:
- 未決事項/メモ:

## 2. 役割別の基本ポリシー（共通）
- 参加者:
  - 全機能をロールに応じて利用
  - キャラクター選択、カード取得/公開/譲渡、投票など可能
- 観戦者:
  - 参加者に紐づく操作は不可
  - 表示は制限（例: 個別ストーリー/目的非表示、非公開カードの閲覧不可）
  - チュートリアルツアーは無効
  - フッターの「この画面について」非表示、プレイヤーリストから除外
- ルームマスター（参加者）:
  - 議論タイマー操作（開始/一時停止/再開/強制終了）
  - ゲーム進行操作（キャラ確定、フェーズ遷移）

---

## 3. フェーズ別仕様（雛形）

以下、各フェーズごとにテンプレート枠を用意しています。必要に応じて詳細を記述してください。

### 3.1 splash
- 概要:
- 入口/出口:
- 主要UI:
- 権限制御（参加者/観戦者/マスター）:
- テスト観点:

### 3.2 start
- 概要:
- 入口/出口:
- 主要UI:
  - ルーム作成/参加モーダル
  - 観戦トグル（参加モーダル内）
- 権限制御:
  - 観戦トグルONで観戦者として入室
- テスト観点:

### 3.3 waiting
- 概要:
- 入口/出口:
- 主要UI:
  - 参加者一覧 / 観戦者一覧
  - 「ゲーム開始」ボタン（マスターのみ）
- 権限制御:
  - ゲーム開始: 参加者数 = PC必要数 のときのみ有効
- テスト観点:

### 3.4 introduction
- 概要:
- 入口/出口:
- 主要UI:
- 権限制御:
- テスト観点:

### 3.5 synopsis
- 概要:
- 入口/出口:
- 主要UI:
- 権限制御:
- テスト観点:

### 3.6 characterSelect
- 概要:
- 入口/出口:
- 主要UI:
  - キャラクターカード一覧（PC/NPC）
- 権限制御:
  - 観戦者: 表示のみ（クリック不可、ホバー変化なし）
  - マスター: 全員選択済みで確定可能
- テスト観点:

### 3.7 commonInfo
- 概要:
- 入口/出口:
- 主要UI:
  - 共通情報テキスト
- 権限制御:
  - 観戦者: フッター BACK/NEXT 非表示
- テスト観点:

### 3.8 individualStory
- 概要:
- 入口/出口:
- 主要UI:
  - 個別ストーリー/目的
- 権限制御:
  - 観戦者: 原則表示対象外（必要に応じて定義）
- テスト観点:

### 3.9 firstDiscussion
- 概要:
- 入口/出口:
- 主要UI:
  - 左: スキル/情報カード/ゲームログ
  - 右: タブ（共通情報/個別ストーリー/目的/見取り図/登場人物一覧 等）
  - フッター: 議論タイマー操作（マスター）、準備ボタン など
- 権限制御:
  - 観戦者: スキル非表示、個別ストーリー/目的タブ非表示
  - 観戦者: 非公開カードはクリック不可、公開カードは閲覧モーダル可
  - 観戦者: 「取得済み: x/y」非表示
  - 観戦者: チュートリアルツアー無効
- テスト観点:

### 3.10 interlude
- 概要:
- 入口/出口:
- 主要UI:
- 権限制御:
- テスト観点:

### 3.11 secondDiscussion
- 概要:
- 入口/出口:
- 主要UI:
  - 第一議論と同様＋中間情報
- 権限制御:
  - 観戦者: スキル非表示、個別ストーリータブ非表示
  - 観戦者: 非公開カードはクリック不可、公開カードは閲覧モーダル可
  - 観戦者: 「取得済み: x/y」非表示
  - 観戦者: チュートリアルツアー無効
- テスト観点:

### 3.12 voting
- 概要:
- 入口/出口:
- 主要UI:
  - 投票UI、進捗表示
- 権限制御:
  - 観戦者: 投票不可、進捗のみ
  - 遷移: 参加者全員投票でエンディングへ
- テスト観点:

### 3.13 ending
- 概要:
- 入口/出口:
- 主要UI:
- 権限制御:
- テスト観点:

### 3.14 debriefing
- 概要:
- 入口/出口:
- 主要UI:
  - あとがき、キャラEND&STORY、情報カード振り返り、ゲームログ
- 権限制御:
  - 観戦者: 表示は可（機能制限があれば記載）
- テスト観点:

---

## 4. ソケットイベント/状態管理（雛形）
- 主要受信イベント:
  - `roomCreated`, `roomJoined`, `updatePlayers`, `gamePhaseChanged`, `charactersConfirmed`, `infoCardsUpdated`, `discussionTimerUpdated`, `voteStateUpdated`, `voteResultFinalized`, `voteTied`, `readingTimeExtended`, `roomClosed`
- 主要送信イベント:
  - `createRoom`, `joinRoom(isSpectator)`, `closeRoom`, `startGame`, `selectCharacter`, `confirmCharacters`, `extendReadingTimer`, `proceedToFirstDiscussion`, `startDiscussionTimer`, `pauseDiscussionTimer`, `resumeDiscussionTimer`, `requestEndDiscussion`, `cancelEndDiscussion`, `confirmEndDiscussion`, `getCard`, `makeCardPublic`, `transferCard`, `submitVote`, `changeGamePhase`, `useActiveSkill`, `setStandBy`
- ステート依存関係（例）:
  - `myPlayer.isSpectator` による権限制御（表示/操作、フッター/ツアー、有効ボタンなど）
  - `characterSelections`, `infoCards`, `discussionTimer`, `voteState` の更新タイミングとUI反映

## 5. 役割別×フェーズ差分（雛形）
> 例: 必要に応じて表形式で整理
- 行: フェーズ
- 列: 参加者/観戦者/マスター
- セル: 表示（可/不可/制限）、操作（可/不可/条件付）、備考

| フェーズ | 参加者 | 観戦者 | マスター |
|---|---|---|---|
| waiting | ○ | ○ | 開始可（条件付） |
| characterSelect | 選択可 | 表示のみ | 確定可（条件付） |
| commonInfo | NEXT可 | フッター非表示 | - |
| firstDiscussion | 通常 | スキル/個別/目的不可 | タイマー操作可 |
| secondDiscussion | 通常 | スキル/個別不可 | タイマー操作可 |
| voting | 投票可 | 進捗のみ | - |
| ending | 表示 | 表示 | - |
| debriefing | 表示 | 表示 | - |

---

## 6. 付録（雛形）
- 用語集: PC/NPC、公開/非公開カード、ルームマスター、観戦者 など
- UIルール: 表示/非表示/disabled/hover抑制 の基本方針
- テストチェックリスト（例）:
  - 観戦者で各フェーズに入室可能か
  - 議論中: 非公開カードのクリック無反応/公開カードのみモーダル可
  - フッターの「この画面について」非表示（観戦者）
  - チュートリアルツアーが観戦者で起動しない
  - 投票: 観戦者は投票不可、進捗は参加者のみ集計
- 変更履歴:
  - yyyy-mm-dd: 初版雛形作成

